{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport axios from 'axios';\n\n//* REFS\nconst refs = {\n  form: document.querySelector('.search-form'),\n  gallery: document.querySelector('.gallery'),\n  searchBtn: document.querySelector('.search-submit '),\n  loader: document.querySelector('.loader'),\n  loadMore: document.querySelector('.load-more'),\n};\n\nlet page = 0;\nlet query = '';\nhide(refs.loader);\nhide(refs.loadMore);\n\n//* SUBMIT FORM\nrefs.form.addEventListener('submit', handleFormSubmit);\n\nasync function handleFormSubmit(e) {\n  refs.gallery.innerHTML = '';\n\n  e.preventDefault();\n  show(refs.loader);\n  hide(refs.loadMore);\n  query = e.currentTarget.searchQuery.value.trim();\n  page = 1;\n\n  if (!query) {\n    return;\n  }\n  try {\n    //* API PIXABAY\n    const resp = await getImage(query, page);\n\n    if (resp.total === 0) {\n      page = 0;\n      refs.searchBtn.disabled = true;\n      hide(refs.loader);\n      hide(refs.loadMore);\n      iziToast.error({\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n      });\n      return;\n    }\n\n    //*   ADD MARKUP\n    hide(refs.loader);\n    refs.gallery.insertAdjacentHTML('beforeend', createMarkup(resp.hits));\n    //*  CROLL SMOOTHLY\n    scroll();\n    show(refs.loadMore);\n\n    //* SIMPLELIGHTBOX\n    const lightbox = new SimpleLightbox('.gallery a', {\n      captions: true,\n      captionsData: 'alt',\n      captionPosition: 'bottom',\n      captionDeloy: 250,\n    });\n    lightbox.on('show.simplelightbox', function (e) {\n      e.preventDefault();\n    });\n    // lightbox.refresh();\n  } catch (error) {\n    console.log(error);\n    hide(refs.loader);\n    hide(refs.loadMore);\n    iziToast.error({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n    });\n  } finally {\n    refs.form.reset();\n    refs.searchBtn.disabled = false;\n  }\n}\n\n// //* MARKUP CARD\nfunction createMarkup(date) {\n  return date\n    .map(\n      ({\n        downloads,\n        likes,\n        webformatURL,\n        largeImageURL,\n        tags,\n        views,\n        comments,\n      }) => `\n        <div class=\"product-card main\">\n        <div class=\"main\">\n        <a href=\"${largeImageURL}\" >\n        <img src=${webformatURL} alt=\"${tags}\" loading=\"lazy\" />\n        </a>\n        <div class=\"info\">\n          <p class=\"info-item\">\n            <b>Likes: ${likes}</b>\n          </p>\n          <p class=\"info-item\">\n            <b>Views: ${views}</b>\n          </p>\n          <p class=\"info-item\">\n            <b>Comments: ${comments}</b>\n          </p>\n          <p class=\"info-item\">\n            <b>Downloads: ${downloads}</b>\n          </p>\n        </div></div>\n\n        </div>\n         `\n    )\n    .join('');\n}\n\n// //* API\nfunction getImage(q, pag = 1) {\n  const URL = 'https://pixabay.com/api/';\n  return axios\n    .get(URL, {\n      params: {\n        key: '39036273-6668926e4f0bebacaced31faa',\n        q,\n        image_type: 'photo',\n        orientation: 'horizontal',\n        safesearch: 'true',\n        page: pag,\n        per_page: 40,\n      },\n    })\n    .then(response => response.data)\n    .catch(error => console.log(error));\n}\n\n//* LOADMORE\nrefs.loadMore.addEventListener('click', handleLoadMore);\nasync function handleLoadMore() {\n  hide(refs.loadMore);\n  show(refs.loader);\n  page += 1;\n\n  try {\n    const resp = await getImage(query, page);\n    if (resp.totalHits < 40 * page) {\n      hide(refs.loader);\n      hide(refs.loadMore);\n      iziToast.warning({\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n      return;\n    }\n    hide(refs.loader);\n    refs.gallery.insertAdjacentHTML('beforeend', createMarkup(resp.hits));\n\n    const lightbox = new SimpleLightbox('.gallery a', {\n      captions: true,\n      captionsData: 'alt',\n      captionPosition: 'bottom',\n      captionDeloy: 250,\n    });\n    lightbox.refresh();\n\n    //*  CROLL SMOOTHLY\n    scroll();\n\n    show(refs.loadMore);\n  } catch (err) {\n    console.log(err);\n    hide(refs.loader);\n    hide(refs.loadMore);\n    return iziToast.error({\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n    });\n  }\n}\n\n// //*  CROLL SMOOTHLY\nfunction scroll() {\n  const card = document.querySelector('.product-card');\n  const rect = card.getBoundingClientRect();\n  window.scrollBy({\n    top: rect.height,\n    behavior: 'smooth',\n  });\n}\n//* HIDE BTN\nfunction hide(el) {\n  el.style.display = 'none';\n}\n\n// *SHOW BTN\nfunction show(el) {\n  el.style.display = 'block';\n}\n"],"names":["refs","page","query","hide","handleFormSubmit","e","show","resp","getImage","iziToast","createMarkup","scroll","SimpleLightbox","error","date","downloads","likes","webformatURL","largeImageURL","tags","views","comments","q","pag","URL","axios","response","handleLoadMore","err","rect","el"],"mappings":"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"}